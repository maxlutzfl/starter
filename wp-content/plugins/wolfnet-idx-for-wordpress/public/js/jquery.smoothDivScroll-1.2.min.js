(function(e){e.widget("thomaskahn.smoothDivScroll",{options:{scrollingHotSpotLeftClass:"scrollingHotSpotLeft",scrollingHotSpotRightClass:"scrollingHotSpotRight",scrollableAreaClass:"scrollableArea",scrollWrapperClass:"scrollWrapper",hiddenOnStart:!1,ajaxContentURL:"",countOnlyClass:"",startAtElementId:"",hotSpotScrolling:!0,hotSpotScrollingStep:15,hotSpotScrollingInterval:10,hotSpotMouseDownSpeedBooster:3,visibleHotSpotBackgrounds:"onstart",hotSpotsVisibleTime:5E3,easingAfterHotSpotScrolling:!0,easingAfterHotSpotScrollingDistance:10,
easingAfterHotSpotScrollingDuration:300,easingAfterHotSpotScrollingFunction:"easeOutQuart",mousewheelScrolling:!1,mousewheelScrollingStep:70,easingAfterMouseWheelScrolling:!0,easingAfterMouseWheelScrollingDuration:300,easingAfterMouseWheelScrollingFunction:"easeOutQuart",manualContinuousScrolling:!1,autoScrollingMode:"",autoScrollingDirection:"endlessloopright",autoScrollingStep:1,autoScrollingInterval:10,scrollToAnimationDuration:1E3,scrollToEasingFunction:"easeOutQuart"},_create:function(){var a=
this,c=this.options,b=this.element;b.wrapInner("<div class='"+c.scrollableAreaClass+"'>").wrapInner("<div class='"+c.scrollWrapperClass+"'>");b.prepend("<div class='"+c.scrollingHotSpotLeftClass+"'></div><div class='"+c.scrollingHotSpotRightClass+"'></div>");b.data("scrollWrapper",b.find("."+c.scrollWrapperClass));b.data("scrollingHotSpotRight",b.find("."+c.scrollingHotSpotRightClass));b.data("scrollingHotSpotLeft",b.find("."+c.scrollingHotSpotLeftClass));b.data("scrollableArea",b.find("."+c.scrollableAreaClass));
b.data("speedBooster",1);b.data("scrollXPos",0);b.data("hotSpotWidth",b.data("scrollingHotSpotLeft").innerWidth());b.data("scrollableAreaWidth",0);b.data("startingPosition",0);b.data("rightScrollingInterval",null);b.data("leftScrollingInterval",null);b.data("autoScrollingInterval",null);b.data("hideHotSpotBackgroundsInterval",null);b.data("previousScrollLeft",0);b.data("pingPongDirection","right");b.data("getNextElementWidth",!0);b.data("swapAt",null);b.data("startAtElementHasNotPassed",!0);b.data("swappedElement",
null);b.data("originalElements",b.data("scrollableArea").children(c.countOnlyClass));b.data("visible",!0);b.data("enabled",!0);b.data("scrollableAreaHeight",b.data("scrollableArea").height());b.data("scrollerOffset",b.offset());b.data("initialAjaxContentLoaded",!1);b.data("scrollingHotSpotRight").bind("mousemove",function(a){a=a.pageX-(this.offsetLeft+b.data("scrollerOffset").left);b.data("scrollXPos",Math.round(a/b.data("hotSpotWidth")*c.hotSpotScrollingStep));Infinity===b.data("scrollXPos")&&b.data("scrollXPos",
0)});b.data("scrollingHotSpotRight").bind("mouseover",function(){b.data("scrollWrapper").stop(!0,!1);a.stopAutoScrolling();b.data("rightScrollingInterval",setInterval(function(){0<b.data("scrollXPos")&&b.data("enabled")&&(b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()+b.data("scrollXPos")*b.data("speedBooster")),c.manualContinuousScrolling&&a._checkContinuousSwapRight(),a._showHideHotSpots())},c.hotSpotScrollingInterval));a._trigger("mouseOverRightHotSpot")});b.data("scrollingHotSpotRight").bind("mouseout",
function(){clearInterval(b.data("rightScrollingInterval"));b.data("scrollXPos",0);c.easingAfterHotSpotScrolling&&b.data("enabled")&&b.data("scrollWrapper").animate({scrollLeft:b.data("scrollWrapper").scrollLeft()+c.easingAfterHotSpotScrollingDistance},{duration:c.easingAfterHotSpotScrollingDuration,easing:c.easingAfterHotSpotScrollingFunction})});b.data("scrollingHotSpotRight").bind("mousedown",function(){b.data("speedBooster",c.hotSpotMouseDownSpeedBooster)});e("body").bind("mouseup",function(){b.data("speedBooster",
1)});b.data("scrollingHotSpotLeft").bind("mousemove",function(a){a=this.offsetLeft+b.data("scrollerOffset").left+b.data("hotSpotWidth")-a.pageX;b.data("scrollXPos",Math.round(a/b.data("hotSpotWidth")*c.hotSpotScrollingStep));Infinity===b.data("scrollXPos")&&b.data("scrollXPos",0)});b.data("scrollingHotSpotLeft").bind("mouseover",function(){b.data("scrollWrapper").stop(!0,!1);a.stopAutoScrolling();b.data("leftScrollingInterval",setInterval(function(){0<b.data("scrollXPos")&&b.data("enabled")&&(b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()-
b.data("scrollXPos")*b.data("speedBooster")),c.manualContinuousScrolling&&a._checkContinuousSwapLeft(),a._showHideHotSpots())},c.hotSpotScrollingInterval));a._trigger("mouseOverLeftHotSpot")});b.data("scrollingHotSpotLeft").bind("mouseout",function(){clearInterval(b.data("leftScrollingInterval"));b.data("scrollXPos",0);c.easingAfterHotSpotScrolling&&b.data("enabled")&&b.data("scrollWrapper").animate({scrollLeft:b.data("scrollWrapper").scrollLeft()-c.easingAfterHotSpotScrollingDistance},{duration:c.easingAfterHotSpotScrollingDuration,
easing:c.easingAfterHotSpotScrollingFunction})});b.data("scrollingHotSpotLeft").bind("mousedown",function(){b.data("speedBooster",c.hotSpotMouseDownSpeedBooster)});b.data("scrollableArea").mousewheel(function(d,e){if(b.data("enabled")&&c.mousewheelScrolling){d.preventDefault();a.stopAutoScrolling();var f=Math.round(c.mousewheelScrollingStep*e);a.move(f)}});c.mousewheelScrolling&&b.data("scrollingHotSpotLeft").add(b.data("scrollingHotSpotRight")).mousewheel(function(a){a.preventDefault()});e(window).bind("resize",
function(){a._showHideHotSpots();a._trigger("windowResized")});0<c.ajaxContentURL.length&&a.changeContent(c.ajaxContentURL,"","html","replace");c.hiddenOnStart&&a.hide();e(window).load(function(){c.hiddenOnStart||a.recalculateScrollableArea();0<c.autoScrollingMode.length&&!c.hiddenOnStart&&a.startAutoScrolling();if("always"!==c.autoScrollingMode)switch(c.visibleHotSpotBackgrounds){case "always":a.showHotSpotBackgrounds();break;case "onstart":a.showHotSpotBackgrounds(),b.data("hideHotSpotBackgroundsInterval",
setTimeout(function(){a.hideHotSpotBackgrounds("slow")},c.hotSpotsVisibleTime))}})},_setOption:function(a,c){var b=this.options,d=this.element;b[a]=c;"hotSpotScrolling"===a?!0===c?this._showHideHotSpots():(d.data("scrollingHotSpotLeft").hide(),d.data("scrollingHotSpotRight").hide()):"autoScrollingStep"===a||"easingAfterHotSpotScrollingDistance"===a||"easingAfterHotSpotScrollingDuration"===a||"easingAfterMouseWheelScrollingDuration"===a?b[a]=parseInt(c,10):"autoScrollingInterval"===a&&(b[a]=parseInt(c,
10),this.startAutoScrolling())},showHotSpotBackgrounds:function(a){var c=this.element;void 0!==a?(c.data("scrollingHotSpotLeft").add(c.data("scrollingHotSpotRight")).css("opacity","0.0"),c.data("scrollingHotSpotLeft").addClass("scrollingHotSpotLeftVisible"),c.data("scrollingHotSpotRight").addClass("scrollingHotSpotRightVisible"),c.data("scrollingHotSpotLeft").add(c.data("scrollingHotSpotRight")).fadeTo(a,0.35)):(c.data("scrollingHotSpotLeft").addClass("scrollingHotSpotLeftVisible"),c.data("scrollingHotSpotLeft").removeAttr("style"),
c.data("scrollingHotSpotRight").addClass("scrollingHotSpotRightVisible"),c.data("scrollingHotSpotRight").removeAttr("style"));this._showHideHotSpots()},hideHotSpotBackgrounds:function(a){var c=this.element;void 0!==a?(c.data("scrollingHotSpotLeft").fadeTo(a,0,function(){c.data("scrollingHotSpotLeft").removeClass("scrollingHotSpotLeftVisible")}),c.data("scrollingHotSpotRight").fadeTo(a,0,function(){c.data("scrollingHotSpotRight").removeClass("scrollingHotSpotRightVisible")})):(c.data("scrollingHotSpotLeft").removeClass("scrollingHotSpotLeftVisible").removeAttr("style"),
c.data("scrollingHotSpotRight").removeClass("scrollingHotSpotRightVisible").removeAttr("style"))},_showHideHotSpots:function(){var a=this.element,c=this.options;c.manualContinuousScrolling&&c.hotSpotScrolling?(a.data("scrollingHotSpotLeft").show(),a.data("scrollingHotSpotRight").show()):"always"!==c.autoScrollingMode&&c.hotSpotScrolling?a.data("scrollableAreaWidth")<=a.data("scrollWrapper").innerWidth()?(a.data("scrollingHotSpotLeft").hide(),a.data("scrollingHotSpotRight").hide()):0===a.data("scrollWrapper").scrollLeft()?
(a.data("scrollingHotSpotLeft").hide(),a.data("scrollingHotSpotRight").show(),this._trigger("scrollerLeftLimitReached"),clearInterval(a.data("leftScrollingInterval")),a.data("leftScrollingInterval",null)):a.data("scrollableAreaWidth")<=a.data("scrollWrapper").innerWidth()+a.data("scrollWrapper").scrollLeft()?(a.data("scrollingHotSpotLeft").show(),a.data("scrollingHotSpotRight").hide(),this._trigger("scrollerRightLimitReached"),clearInterval(a.data("rightScrollingInterval")),a.data("rightScrollingInterval",
null)):(a.data("scrollingHotSpotLeft").show(),a.data("scrollingHotSpotRight").show()):(a.data("scrollingHotSpotLeft").hide(),a.data("scrollingHotSpotRight").hide())},_setElementScrollPosition:function(a,c){var b=this.element,d=this.options,g=0;switch(a){case "first":return b.data("scrollXPos",0),!0;case "start":return""!==d.startAtElementId&&b.data("scrollableArea").has("#"+d.startAtElementId)?(g=e("#"+d.startAtElementId).position().left,b.data("scrollXPos",g),!0):!1;case "last":return b.data("scrollXPos",
b.data("scrollableAreaWidth")-b.data("scrollWrapper").innerWidth()),!0;case "number":return!isNaN(c)?(g=b.data("scrollableArea").children(d.countOnlyClass).eq(c-1).position().left,b.data("scrollXPos",g),!0):!1;case "id":return 0<c.length&&b.data("scrollableArea").has("#"+c)?(g=e("#"+c).position().left,b.data("scrollXPos",g),!0):!1;default:return!1}},jumpToElement:function(a,c){var b=this.element;if(b.data("enabled")&&this._setElementScrollPosition(a,c))switch(b.data("scrollWrapper").scrollLeft(b.data("scrollXPos")),
this._showHideHotSpots(),a){case "first":this._trigger("jumpedToFirstElement");break;case "start":this._trigger("jumpedToStartElement");break;case "last":this._trigger("jumpedToLastElement");break;case "number":this._trigger("jumpedToElementNumber",null,{elementNumber:c});break;case "id":this._trigger("jumpedToElementId",null,{elementId:c})}},scrollToElement:function(a,c){var b=this,d=this.element,e=this.options,f=!1;d.data("enabled")&&b._setElementScrollPosition(a,c)&&(null!==d.data("autoScrollingInterval")&&
(b.stopAutoScrolling(),f=!0),d.data("scrollWrapper").stop(!0,!1),d.data("scrollWrapper").animate({scrollLeft:d.data("scrollXPos")},{duration:e.scrollToAnimationDuration,easing:e.scrollToEasingFunction,complete:function(){f&&b.startAutoScrolling();b._showHideHotSpots();switch(a){case "first":b._trigger("scrolledToFirstElement");break;case "start":b._trigger("scrolledToStartElement");break;case "last":b._trigger("scrolledToLastElement");break;case "number":b._trigger("scrolledToElementNumber",null,
{elementNumber:c});break;case "id":b._trigger("scrolledToElementId",null,{elementId:c})}}}))},move:function(a){var c=this,b=this.element,d=this.options;b.data("scrollWrapper").stop(!0,!0);if(0>a&&0<b.data("scrollWrapper").scrollLeft()||0<a&&b.data("scrollableAreaWidth")>b.data("scrollWrapper").innerWidth()+b.data("scrollWrapper").scrollLeft())d.easingAfterMouseWheelScrolling?b.data("scrollWrapper").animate({scrollLeft:b.data("scrollWrapper").scrollLeft()+a},{duration:d.easingAfterMouseWheelScrollingDuration,
easing:d.easingAfterMouseWheelFunction,complete:function(){c._showHideHotSpots();d.manualContinuousScrolling&&(0<a?c._checkContinuousSwapRight():c._checkContinuousSwapLeft())}}):(b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()+a),c._showHideHotSpots(),d.manualContinuousScrolling&&(0<a?c._checkContinuousSwapRight():c._checkContinuousSwapLeft()))},changeContent:function(a,c,b,d){var g=this,f=this.element;switch(c){case "flickrFeed":e.getJSON(a,function(a){function c(a,i){var o=
a.media.m.replace("_m",j[i].letter);e("<img />").attr("src",o).load(function(){this.height<f.data("scrollableAreaHeight")?i+1<j.length?c(a,i+1):k(this):k(this);if(l===p){switch(b){case "add":"first"===d?f.data("scrollableArea").children(":first").before(h):f.data("scrollableArea").children(":last").after(h);break;default:f.data("scrollableArea").html(h)}f.data("initialAjaxContentLoaded")?g.recalculateScrollableArea():f.data("initialAjaxContentLoaded",!0);g._showHideHotSpots();g._trigger("addedFlickrContent",
null,{addedElementIds:m})}})}function k(a){var b=f.data("scrollableAreaHeight")/a.height,b=Math.round(a.width*b),c=e(a).attr("src").split("/"),c=c[c.length-1].split(".");e(a).attr("id",c[0]);e(a).css({height:f.data("scrollableAreaHeight"),width:b});m.push(c[0]);h.push(a);l++}var j=[{size:"small square",pixels:75,letter:"_s"},{size:"thumbnail",pixels:100,letter:"_t"},{size:"small",pixels:240,letter:"_m"},{size:"medium",pixels:500,letter:""},{size:"medium 640",pixels:640,letter:"_z"},{size:"large",
pixels:1024,letter:"_b"}],h=[],m=[],n,p=a.items.length,l=0;n=75>=f.data("scrollableAreaHeight")?0:100>=f.data("scrollableAreaHeight")?1:240>=f.data("scrollableAreaHeight")?2:500>=f.data("scrollableAreaHeight")?3:640>=f.data("scrollableAreaHeight")?4:5;e.each(a.items,function(a,b){c(b,n)})});break;default:e.get(a,function(a){switch(b){case "add":"first"===d?f.data("scrollableArea").children(":first").before(a):f.data("scrollableArea").children(":last").after(a);break;default:f.data("scrollableArea").html(a)}f.data("initialAjaxContentLoaded")?
g.recalculateScrollableArea():f.data("initialAjaxContentLoaded",!0);g._showHideHotSpots();g._trigger("addedHtmlContent")})}},recalculateScrollableArea:function(){var a=0,c=!1,b=this.options,d=this.element;d.data("scrollableArea").children(b.countOnlyClass).each(function(){0<b.startAtElementId.length&&e(this).attr("id")===b.startAtElementId&&(d.data("startingPosition",a),c=!0);a+=e(this).outerWidth(!0)});c||d.data("startAtElementId","");d.data("scrollableAreaWidth",a);d.data("scrollableArea").width(d.data("scrollableAreaWidth"));
d.data("scrollWrapper").scrollLeft(d.data("startingPosition"));d.data("scrollXPos",d.data("startingPosition"))},stopAutoScrolling:function(){var a=this.element;null!==a.data("autoScrollingInterval")&&(clearInterval(a.data("autoScrollingInterval")),a.data("autoScrollingInterval",null),this._showHideHotSpots(),this._trigger("autoScrollingStopped"))},startAutoScrolling:function(){var a=this,c=this.element,b=this.options;c.data("enabled")&&(a._showHideHotSpots(),clearInterval(c.data("autoScrollingInterval")),
c.data("autoScrollingInterval",null),a._trigger("autoScrollingStarted"),c.data("autoScrollingInterval",setInterval(function(){if(!c.data("visible")||c.data("scrollableAreaWidth")<=c.data("scrollWrapper").innerWidth())clearInterval(c.data("autoScrollingInterval")),c.data("autoScrollingInterval",null);else switch(c.data("previousScrollLeft",c.data("scrollWrapper").scrollLeft()),b.autoScrollingDirection){case "right":c.data("scrollWrapper").scrollLeft(c.data("scrollWrapper").scrollLeft()+b.autoScrollingStep);
c.data("previousScrollLeft")===c.data("scrollWrapper").scrollLeft()&&(a._trigger("autoScrollingRightLimitReached"),clearInterval(c.data("autoScrollingInterval")),c.data("autoScrollingInterval",null),a._trigger("autoScrollingIntervalStopped"));break;case "left":c.data("scrollWrapper").scrollLeft(c.data("scrollWrapper").scrollLeft()-b.autoScrollingStep);c.data("previousScrollLeft")===c.data("scrollWrapper").scrollLeft()&&(a._trigger("autoScrollingLeftLimitReached"),clearInterval(c.data("autoScrollingInterval")),
c.data("autoScrollingInterval",null),a._trigger("autoScrollingIntervalStopped"));break;case "backandforth":"right"===c.data("pingPongDirection")?c.data("scrollWrapper").scrollLeft(c.data("scrollWrapper").scrollLeft()+b.autoScrollingStep):c.data("scrollWrapper").scrollLeft(c.data("scrollWrapper").scrollLeft()-b.autoScrollingStep);c.data("previousScrollLeft")===c.data("scrollWrapper").scrollLeft()&&("right"===c.data("pingPongDirection")?(c.data("pingPongDirection","left"),a._trigger("autoScrollingRightLimitReached")):
(c.data("pingPongDirection","right"),a._trigger("autoScrollingLeftLimitReached")));break;case "endlessloopright":c.data("scrollWrapper").scrollLeft(c.data("scrollWrapper").scrollLeft()+b.autoScrollingStep);a._checkContinuousSwapRight();break;case "endlessloopleft":c.data("scrollWrapper").scrollLeft(c.data("scrollWrapper").scrollLeft()-b.autoScrollingStep),a._checkContinuousSwapLeft()}},b.autoScrollingInterval)))},_checkContinuousSwapRight:function(){var a=this.element,c=this.options;a.data("getNextElementWidth")&&
(0<c.startAtElementId.length&&a.data("startAtElementHasNotPassed")?(a.data("swapAt",e("#"+c.startAtElementId).outerWidth(!0)),a.data("startAtElementHasNotPassed",!1)):a.data("swapAt",a.data("scrollableArea").children(":first").outerWidth(!0)),a.data("getNextElementWidth",!1));a.data("swapAt")<=a.data("scrollWrapper").scrollLeft()&&(a.data("swappedElement",a.data("scrollableArea").children(":first").detach()),a.data("scrollableArea").append(a.data("swappedElement")),c=a.data("scrollWrapper").scrollLeft(),
a.data("scrollWrapper").scrollLeft(c-a.data("swappedElement").outerWidth(!0)),a.data("getNextElementWidth",!0))},_checkContinuousSwapLeft:function(){var a=this.element,c=this.options;a.data("getNextElementWidth")&&(0<c.startAtElementId.length&&a.data("startAtElementHasNotPassed")?(a.data("swapAt",e("#"+c.startAtElementId).outerWidth(!0)),a.data("startAtElementHasNotPassed",!1)):a.data("swapAt",a.data("scrollableArea").children(":first").outerWidth(!0)),a.data("getNextElementWidth",!1));0===a.data("scrollWrapper").scrollLeft()&&
(a.data("swappedElement",a.data("scrollableArea").children(":last").detach()),a.data("scrollableArea").prepend(a.data("swappedElement")),a.data("scrollWrapper").scrollLeft(a.data("scrollWrapper").scrollLeft()+a.data("swappedElement").outerWidth(!0)),a.data("getNextElementWidth",!0))},restoreOriginalElements:function(){var a=this.element;a.data("scrollableArea").html(a.data("originalElements"));this.recalculateScrollableArea();this.jumpToElement("first")},show:function(){var a=this.element;a.data("visible",
!0);a.show()},hide:function(){var a=this.element;a.data("visible",!1);a.hide()},enable:function(){this.element.data("enabled",!0)},disable:function(){var a=this.element;this.stopAutoScrolling();clearInterval(a.data("rightScrollingInterval"));clearInterval(a.data("leftScrollingInterval"));clearInterval(a.data("hideHotSpotBackgroundsInterval"));a.data("enabled",!1)},destroy:function(){var a=this.element;this.stopAutoScrolling();clearInterval(a.data("rightScrollingInterval"));clearInterval(a.data("leftScrollingInterval"));
clearInterval(a.data("hideHotSpotBackgroundsInterval"));a.data("scrollingHotSpotRight").unbind("mouseover");a.data("scrollingHotSpotRight").unbind("mouseout");a.data("scrollingHotSpotRight").unbind("mousedown");a.data("scrollingHotSpotLeft").unbind("mouseover");a.data("scrollingHotSpotLeft").unbind("mouseout");a.data("scrollingHotSpotLeft").unbind("mousedown");a.data("scrollingHotSpotRight").remove();a.data("scrollingHotSpotLeft").remove();a.data("scrollableArea").remove();a.data("scrollWrapper").remove();
a.html(a.data("originalElements"));e.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
