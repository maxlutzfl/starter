!function(a){var b="wolfnetSmartSearch",c=b+".state",d={fields:[],minLength:3,fieldMap:{},searchField:null,suggestionHoverClass:"wnt-hover"},e={init:function(b){return b.ajaxUrl?b.ajaxAction?this.each(function(){var f=a(this),g=a.extend(!0,{},d,b);0===g.fields.length&&g.fields.push(f.attr("name")),f.data(c,g),e.createInputControl(f),e.createSuggestionControl(f),e.defineEvents(f),e.refreshExistingValues(f,null,!1)}):(a.error('The "ajaxAction" option must be included when initializing the plugin.'),this):(a.error('The "ajaxUrl" option must be included when initializing the plugin.'),this)},disable:function(){return this.each(function(){var b=a(this),d=b.data(c),e=d.listContainer;b.prop("disabled",!0),e.hide()})},enable:function(){return this.each(function(){var b=a(this),d=b.data(c),e=d.listContainer;b.prop("disabled",!1),e.show()})},getContainer:function(){var b=a();return this.each(function(){var d=a(this),e=d.data(c),f=e.listContainer;b=b.add(f)}),b},createInputControl:function(b){var d=a(b[0].form),f=b.data(c),g=a("<input>").attr({autocomplete:"off",name:"q"==b.attr("name")?"q":"",placeholder:b.attr("placeholder"),type:"text"}).css({outline:"none",minWidth:"5em",width:"100%"}).val(b.val()),h=a("<span>").addClass("wnt-smart-search-input").css({display:"inline-block",width:"100%"}).append(g),i=a("<span>").addClass(b.attr("class")).css({"text-align":"left"}).append(h).click(function(){g.focus()}).resize(function(){e.resizeSuggestionsList(b)}).insertBefore(b);b.is(":focus")&&g.focus(),b.hide(),b.prependTo(d),"q"==b.attr("name")&&(b.removeAttr("name"),g.val(b.val())),f.searchInput=g,f.listContainer=i,b.data(c,f)},createSuggestionControl:function(b){var d=b.data(c),e=d.listContainer;d.searchInput;d.searchingClass="wnt-message-searching"+d.componentId;var f=a("<div>").addClass(d.searchingClass).text("Searching ..."),g=a("<div>").addClass("wnt-suggestions").css({position:"absolute",left:0,width:e.outerWidth()+1,backgroundColor:"white",zIndex:9e6}).hide().append(f).appendTo(a(".smart-menu"+d.componentId));d.suggestionContainer=g,b.data(c,d)},updateSuggestionsList:function(b,d){var f=b.data(c),g=(f.listContainer,f.suggestionContainer),h=(f.searchInput,f.suggestionHoverClass);if(e.resizeSuggestionsList(b),e.resetSuggestionsList(b),d.length>0){for(var i in d)var j=a("<span>").text(d[i].value).addClass("wolfnet-suggestion-label"),k=a("<span>").text(d[i].label).addClass("wolfnet-suggestion-field"),l=a("<span>").css("clear","both"),m=a("<div>").addClass("wnt-suggestion").data("value",d[i].value).data("field",d[i].field).append(j).append(k).append(l).appendTo(g).on("click",e.suggestionClick).on("mouseover",{$smartSearch:b},e.suggestionMouseover).on("wntSelect",{$smartSearch:b},e.suggestionOnWntSearch);g.children(".wnt-suggestion:first").addClass(h),e.showSuggestionsList(b)}else e.resetSuggestionsList(b)},defineEvents:function(b){var d=b.data(c),f=d.searchInput,g=(d.listContainer,d.suggestionContainer),h=a(b[0].form);h.width()<=400&&e.applyNarrowCSS(h),b.on("wntFocus",function(a){f.focus()});for(var i=0,j=d.fields.length;i<j;i++){var k=h.find('input[name="'+d.fields[i]+'"]');k.on("change",{$smartSearch:b},e.fieldChange)}f.on("keydown",{$smartSearch:b},e.searchInputKeydown).on("keyup",{$smartSearch:b},e.searchInputKeyup).on("blur",{$smartSearch:b},e.searchInputBlur).on("focus",{$smartSearch:b},e.searchInputFocus),g.on("mouseover",{$smartSearch:b},e.suggestionContainerMouseover).on("mouseout",{$smartSearch:b},e.suggestionContainerMouseout),h.on("reset",function(){e.removeAllValues(b)})},getFieldNameFromFieldMap:function(a,b){var d=a.data(c).fieldMap||{};return d[b]||b},suggestionsVisibleWithResults:function(a){var b=a.data(c).suggestionContainer,d=b.is(":not(:hidden)"),e=b.find(".wnt-suggestion").length>0;return d&&e},widestElementWidth:function(b){var c=0;return b.each(function(){var b=a(this).outerWidth();c=b>c?b:c}),c},input:function(b,d){var f=b.data(c);f.suggestionContainer;if(f.xhr&&f.xhr.abort(),d.length>=f.minLength){var g={term:d};f.searchField&&(g.field=f.searchField),f.xhr=a.ajax({url:f.ajaxUrl,data:{action:f.ajaxAction,data:g},dataType:"jsonp",context:b,beforeSend:function(){e.showSearchingMessage(this)}}).done(function(a){e.updateSuggestionsList(this,a)}).always(function(a){e.hideSearchingMessage(this)}),b.data(c,f)}else e.resetSuggestionsList(b)},addValue:function(b,d,f,g){g="undefined"!=typeof g&&g;var h=b.data(c),i=(h.listContainer,a(b[0].form)),j=h.searchInput,k=!1;f=e.getFieldNameFromFieldMap(b,f);var l=i.find('input[name="'+f+'"]');0===l.length&&(l=a("<input>").attr({name:f,type:"hidden"}).appendTo(i));var m=l.val().split(",");a.inArray(d,m)==-1&&(k=!0,m.push(d)),l.val(m.join(",").replace(/(^,)|(,$)/g,""));var n=a("<span>").data("value",d).data("field",f).addClass("wnt-ss-value").css("display","inline-block").on("wntRemove",function(){var c=a(this),d=c.data("value"),f=c.data("field");e.removeValue(b,d,f)});a("<span>").text(d).appendTo(n),a("<span>").addClass("wnt-close-btn").addClass("icon").addClass("icon-close").html("<span>x</span>").appendTo(n).click(function(){var b=a(this).parent();b.trigger("wntRemove")});if(n.insertBefore(j.parent()),e.resizeSuggestionsList(b),!g&&(b.trigger("wntSmartSearchUpdated"),k)){var o=jQuery.Event("change");o.relatedTarget=b[0],l.trigger(o)}},removeValue:function(b,d,f){var g=b.data(c),h=g.listContainer,i=a(b[0].form),j=!1;f=e.getFieldNameFromFieldMap(b,f)||f;var k=i.find('input[name="'+f+'"]');if(0!==k.length){var l=a.grep(k.val().split(","),function(a){return j=a==d||j,a!=d});if(k.val(l.join(",").replace(/(^,)|(,$)/g,"")),h.children(".wnt-ss-value").each(function(){var b=a(this),c=b.data("value")||"",e=b.data("field")||"";c==d&&f&&e==f&&b.remove()}),e.resizeSuggestionsList(b),b.trigger("wntSmartSearchUpdated"),j){var m=jQuery.Event("change");m.relatedTarget=b[0],k.trigger(m)}}},removeAllValues:function(b){var d=b.data(c),f=d.listContainer;f.children(".wnt-ss-value").each(function(){var c=a(this),d=c.data("value")||"",f=c.data("field")||"";""!==d&&""!==f&&e.removeValue(b,d,f)})},removeMostRecentValue:function(b){var d=b.data(c).listContainer||a("<span>");d.children(".wnt-ss-value:last").trigger("wntRemove")},showSuggestionsList:function(b){var d=b.data(c).suggestionContainer.show(),f=e.widestElementWidth(d.find(".wolfnet-suggestion-field")),g=d.find(".wnt-suggestion:first").width()-f;d.find(".wolfnet-suggestion-label").each(function(){var b=a(this);b.width()>g-10&&b.width(g-10)})},hideSuggestionsList:function(a){a.data(c).suggestionContainer.hide()},resetSuggestionsList:function(a){var b=a.data(c),d=b.suggestionContainer,f=d.children(".wnt-suggestion");e.hideSuggestionsList(a),f.remove()},moveSuggestionSelectUp:function(a){var b=a.data(c),d=b.suggestionContainer,e=d.find(".wnt-suggestion.wnt-hover"),f=e.prev(".wnt-suggestion");f.length&&(f.addClass("wnt-hover"),e.removeClass("wnt-hover"))},moveSuggestionSelectDown:function(a){var b=a.data(c),d=b.suggestionContainer,e=d.find(".wnt-suggestion.wnt-hover"),f=e.next(".wnt-suggestion");f.length&&(f.addClass("wnt-hover"),e.removeClass("wnt-hover"))},selectHighlightedSuggestion:function(a){var b=a.data(c),d=b.suggestionContainer,e=d.find(".wnt-suggestion.wnt-hover");e.trigger("wntSelect")},showSearchingMessage:function(a){var b=a.data(c);b.suggestionContainer.children("."+b.searchingClass).show(),e.showSuggestionsList(a)},hideSearchingMessage:function(a){var b=a.data(c);b.suggestionContainer.children("."+b.searchingClass).hide()},refreshExistingValues:function(b,d,f){f="undefined"!=typeof f&&f;for(var g=a(b[0].form),h=b.data(c),i=h.listContainer,j={},k=[],l=[],m=0,n=h.fields.length;m<n;m++){var o=g.find('input[name="'+h.fields[m]+'"]');if(0!==o.length){var p=a.trim(o.val()).split(",");j[h.fields[m]]=p;for(var q=0,r=p.length;q<r;q++){var s=h.fields[m],t=p[q];""!==a.trim(p[q])&&k.push({field:s,value:t})}}}i.find("span.wnt-ss-value").each(function(){for(var b=a(this),c={field:b.data("field"),value:b.data("value")},d=0,e=[],f=k.length;d<f;d++){var g=k[d];g.field==c.field&&g.value==c.value||e.push(g)}k=e,j[c.field]&&a.inArray(c.value,j[c.field])!=-1||l.push(c)});for(var u=0,v=k.length;u<v;u++)e.addValue(b,k[u].value,k[u].field,f);for(var w=0,x=l.length;w<x;w++)e.removeValue(b,l[w].value,l[w].field)},resizeSuggestionsList:function(a){var b=a.data(c),d=b.listContainer,f=b.suggestionContainer;d.offset();e.toggleInputPlaceholder(a);var g=0,h=d.outerWidth()+parseInt(d.css("margin-left"))+parseInt(d.css("margin-right"));f.css({top:top,left:g,width:h})},toggleInputPlaceholder:function(b){var d=b.data(c),e=d.searchInput,f=d.listContainer,g=f.children(".wnt-ss-value").children().length;0===g?(a(".wnt-smart-search-input").css("width","100%"),e.attr("placeholder",b.attr("placeholder")).css("width","100%")):(a(".wnt-smart-search-input").css("width",0),e.attr("placeholder","").css("width","auto"))},searchInputKeydown:function(b){var c=a(this),d=b.data.$smartSearch;switch(b.keyCode){case 9:case 16:case 17:case 18:case 19:case 20:case 33:case 34:case 35:case 36:case 37:case 39:case 45:case 91:case 92:case 93:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 144:case 145:case 186:case 187:case 188:case 189:case 192:return!0;case 13:if(""!==c.val()&&e.suggestionsVisibleWithResults(d))return b.preventDefault(),e.selectHighlightedSuggestion(d),!1;break;case 8:""===c.val()&&e.removeMostRecentValue(d);break;case 40:case 38:return b.preventDefault(),!1}},searchInputKeyup:function(b){var c=a(this),d=b.data.$smartSearch,f=(c.parent().parent(),a(d[0].form));switch("q"==d.attr("name")&&d.trigger(b),b.keyCode){case 9:case 16:case 17:case 18:case 19:case 20:case 33:case 34:case 35:case 36:case 37:case 39:case 45:case 91:case 92:case 93:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 144:case 145:case 186:case 187:case 188:case 189:case 192:return!0;case 27:return e.hideSuggestionsList(d),!1;case 13:return e.suggestionsVisibleWithResults(d)?(b.preventDefault(),!1):(f.submit(),!0);case 40:return b.preventDefault(),e.moveSuggestionSelectDown(d),!1;case 38:return b.preventDefault(),e.moveSuggestionSelectUp(d),!1;case 8:return e.input(d,c.val()),e.toggleInputPlaceholder(d),!0;default:e.input(d,c.val())}},searchInputBlur:function(a){var b=a.data.$smartSearch,d=b.data(c),f=d.listContainer;f.removeClass("focus"),d.overSuggestions||e.hideSuggestionsList(b)},searchInputFocus:function(a){var b=a.data.$smartSearch,d=b.data(c),f=d.listContainer;f.addClass("focus"),e.resetSuggestionsList(b)},suggestionContainerMouseover:function(a){var b=a.data.$smartSearch,d=b.data(c);d.overSuggestions=!0,b.data(c,d)},suggestionContainerMouseout:function(a){var b=a.data.$smartSearch,d=b.data(c),f=d.searchInput;d.overSuggestions=!1,b.data(c,d),f.is(":focus")||e.hideSuggestionsList(b)},suggestionClick:function(b){var c=a(this);c.trigger("wntSelect")},suggestionMouseover:function(b){var d=a(this),e=b.data.$smartSearch,f=e.data(c).suggestionHoverClass;d.addClass(f),d.siblings("."+f).removeClass(f)},suggestionOnWntSearch:function(b){var d=a(this),f=b.data.$smartSearch,g=f.data(c),h=g.searchInput,i=d.data("value"),j=d.data("field");h.val(""),e.resetSuggestionsList(f),e.addValue(f,i,j),f.trigger("wntFocus")},fieldChange:function(a){var b=a.data.$smartSearch;a.relatedTarget!=b[0]&&e.refreshExistingValues(b,a)},applyNarrowCSS:function(a){a.find(".wolfnet_smartPriceFields").css({width:"100%",clear:"both"}),a.find(".wolfnet_smartBedBathFields").css({width:"100%",clear:"both"}),a.find(".wolfnet_smartSubmit").css({width:"100%",clear:"both"}),a.find(".wolfnet_smartMinPrice").css({width:"50%"}),a.find(".wolfnet_smartMaxPrice").css({width:"50%"}),a.find(".wolfnet_smartBeds").css({width:"50%"}),a.find(".wolfnet_smartBaths").css({width:"50%"})}};a.fn[b]=function(b){return e[b]?e[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery."+pluginName):e.init.apply(this,arguments)}}(jQuery);
//# sourceMappingURL=jquery.wolfnetSmartsearch.min.js.map