(function(f){var l={sort:"price_desc",maxResults:250,criteria:{},itemsPerPageData:[5,10,15,20,25,30,35,40,45,50],sortOptionsData:[{value:"price_desc",label:"Descending by Price"},{value:"price",label:"Ascending by Price"}]},j=function(a,b){var c=f(b);c.attr("id",a.property_id);c.find("a.wolfnet_listingLink").attr("href",a.property_url);c.find(".wolfnet_listingImage img").attr({src:a.thumbnail_url,alt:"Property for sale at "+a.address,"data-photo-url":a.thumbnails_url});c.find(".wolfnet_price").attr("title",
a.listing_price).text(a.listing_price);c.find(".wolfnet_bed_bath").attr("title",a.bedsbaths_full);a.total_bedrooms&&(c.find(".wolfnet_beds").text(a.total_bedrooms).show(),a.total_baths&&c.find(".wolfnet_bed_bath .wolfnet_info_separator").show());a.total_baths&&c.find(".wolfnet_baths").text(a.total_baths).show();c.find(".wolfnet_locationInfo").attr("title",a.address);c.find(".wolfnet_address").text(a.display_address);c.find(".wolfnet_location").text(a.location);c.find(".wolfnet_full_address").text(a.address);
var e=c.find(".wolfnet_branding"),d=e.find(".wolfnet_brokerLogo");"idx"===a.branding.type&&!d.is(".wolfnet_idxLogo")&&d.addClass("wolfnet_idxLogo");""!==f.trim(a.branding.logo)&&d.show().find("img").first().attr("src",a.branding.logo);e.find(".wolfnet_brandingCourtesyText").html(a.branding.courtesy_text);e.find(".wolfnet_brandingAgent.wolfnet_brandingAgentName").html(a.branding.agent_name);e.find(".wolfnet_brandingAgent.wolfnet_brandingAgentPhone").html(a.branding.agent_phone);e.find(".wolfnet_brandingOffice.wolfnet_brandingOfficeName").html(a.branding.office_name);
e.find(".wolfnet_brandingOffice.wolfnet_brandingOfficePhone").html(a.branding.office_phone);e.find(".wolfnet_brandingTollFreePhone").html(a.branding.toll_free_phone);return c},k=function(a){(this.is(".wolfnet_propertyList")||this.is(".wolfnet_listingGrid"))&&this.find(".wolfnet_listings").children().remove();if(this.is(".wolfnet_propertyList")){for(var b=a,b=f.isArray(b.responseData.data.listing)?b.responseData.data.listing:[],c=f("<div>").addClass("wolfnet_listings"),e=0,d=b.length;e<d;e++){var h=
b[e].display_address+", "+(b[e].city+", "+b[e].state),g=f("<div>").attr("id","wolfnet_listing_"+b[e].property_id).addClass("wolfnet_listing").appendTo(c),g=f("<a>").attr({href:b[e].property_url,title:h}).appendTo(g);f("<span>").addClass("wolfnet_price").attr("itemprop","price").html(b[e].listing_price.toString()).appendTo(g);f("<span>").addClass("wolfnet_full_address").attr("itemprop","street-address").html(h).appendTo(g)}this.find(".wolfnet_listings").replaceWith(c)}else if(this.is(".wolfnet_listingGrid")){b=
f.isArray(a.responseData.data.listing)?a.responseData.data.listing:[];c=a.responseData.data.hasOwnProperty("templates")?a.responseData.data.templates:{};e=f("<div>").addClass("wolfnet_listings");if(c.hasOwnProperty("listing")){d=0;for(h=b.length;d<h;d++)e.append(j(b[d],c.listing))}this.find(".wolfnet_listings").replaceWith(e);this.wolfnetListingGrid("refresh")}if(0<this.find(".wolfnet_wntMainMap").length){b=f.isArray(a.responseData.data.listing)?a.responseData.data.listing:[];a=a.responseData.data.hasOwnProperty("templates")?
a.responseData.data.templates:{};c=this.find(".wolfnet_wntMainMap").data("map");e=wolfnet_ajax.houseoverIcon;c.removeAllShapes();d=0;for(h=b.length;d<h;d++)if(g=a.hasOwnProperty("map")?j(b[d],a.map).get(0):"",(0!==b[d].geo.lat||0!==b[d].geo.lng)&&(!isNaN(b[d].geo.lat)||!isNaN(b[d].geo.lng))&&(""!==b[d].geo.lat||""!==b[d].geo.lng)&&-180<=b[d].geo.lat&&180>=b[d].geo.lat&&-180<=b[d].geo.lng&&180>=b[d].geo.lng){var i=c.mapIcon(e,20,20),g=c.poi(b[d].geo.lat,b[d].geo.lng,i,g,b[d].property_id,b[d].property_url);
b[d].geo.lat>=c.getBounds().lr.lat-50&&b[d].geo.lat<=c.getBounds().ul.lat+50&&(b[d].geo.lng>=c.getBounds().lr.lng-50&&b[d].geo.lng<=c.getBounds().ul.lng+50)&&c.addPoi(g)}c.bestFit()}this.trigger("wolfnet.updated")},m=function(){var a=f(this),b=a.find("span.wolfnet_page_items_select"),c=a.data("wolfnetToolbar.state"),e=a.data("wolfnetToolbar.options");if(0===b.length&&a.is(".wolfnet_withPagination")){var d=f("<select>");d.change(function(){c.numrows=f(this).val();a.data("wolfnetToolbar.state",c);a.find("span.wolfnet_page_items_select select").val(c.numrows);
i.update.call(a)});for(var b=0,h=e.itemsPerPageData.length;b<h;b++){var g=e.itemsPerPageData[b];f("<option>").attr("value",g).text(g).appendTo(d)}b=f("<span>").addClass("wolfnet_page_items_select");b.append(d).append("per page");b.appendTo(a.find(".wolfnet_toolbar .wolfnet_page_items"))}a.find("span.wolfnet_page_items_select select").each(function(){f(this).val(Number(c.numrows))})},n=function(){var a=f(this),b=a.find("span.wolfnet_sortoptions select"),c=a.data("wolfnetToolbar.state"),e=a.data("wolfnetToolbar.options");
if(0===b.length&&a.is(".wolfnet_withSortOptions")){var d=f("<select>");d.change(function(){c.sort=f(this).val();a.data("wolfnetToolbar.state",c);a.find("span.wolfnet_sortoptions select").val(c.sort);i.update.call(a)});for(var b=0,h=e.sortOptionsData.length;b<h;b++){var g=e.sortOptionsData[b];f("<option>").text(g.label).attr("value",g.value).appendTo(d)}b=f("<span>").addClass("wolfnet_sortoptions");b.append(d);b.appendTo(a.find(".wolfnet_toolbar .wolfnet_page_info"))}a.find("span.wolfnet_sortoptions select").each(function(){f(this).val(c.sort)})},
o=function(){var a=f(this),b=a.find("a.wolfnet_page_nav_next"),c=a.find("a.wolfnet_page_nav_prev"),e=a.data("wolfnetToolbar.state"),d=a.data("wolfnetToolbar.options"),h=Math.ceil(d.maxResults/e.numrows);1>=e.page?c.addClass("wolfnet_disabled"):c.removeClass("wolfnet_disabled");e.page>=h?b.addClass("wolfnet_disabled"):b.removeClass("wolfnet_disabled");b=Number(e.startrow)-1+Number(e.numrows);Number(d.maxResults)<b&&(b=Number(d.maxResults));a.find(".wolfnet_page_start").text(e.startrow);a.find(".wolfnet_page_end").text(b);
f("html,body").scrollTop(a.find(".wolfnet_toolbar").offset().top-100);a.is(".wolfnet_listingGrid")&&a.wolfnetListingGrid&&a.wolfnetListingGrid("refresh",!0);a.removeClass("wolfnet_refreshing");return!0},i={init:function(a){return this.each(function(){var b=f(this),c=f.extend(!0,{},l,a),e=f.extend(!0,{},c.criteria,c,{page:1});delete c.criteria;delete e.criteria;delete e.prices;delete e.ownertypes;delete e.savedsearches;for(var d in e){var h=-1!==d.indexOf("_wpname"),g=-1!==d.indexOf("_wpid"),j=-1!==
d.indexOf("_wpc"),k=-1!==d.indexOf("_wps");(h||g||j||k)&&delete e[d]}e.maxresults=c.maxResults;-1===f.inArray(Number(e.numrows),c.itemsPerPageData)&&c.itemsPerPageData.push(Number(e.numrows));c.itemsPerPageData.sort(function(a,b){return a-b});b.data("wolfnetToolbar.options",c);b.data("wolfnetToolbar.state",e);m.call(b);n.call(b);b.click(function(a){var c=f(a.target);return c.is("a.wolfnet_page_nav_next")||c.parent().is("a.wolfnet_page_nav_next")?(a.preventDefault(),i.next.call(b),!1):c.is("a.wolfnet_page_nav_prev")||
c.parent().is("a.wolfnet_page_nav_prev")?(a.preventDefault(),i.prev.call(b),!1):!0});b.on("wolfnet.updated",o)})},update:function(){return this.each(function(){var a=f(this),b=a.data("wolfnetToolbar.state");f.ajax({url:wolfnet_ajax.ajaxurl,dataType:"jsonp",data:function(){var a=f.extend(b,{});delete a.itemsPerPageData;delete a.sortOptionsData;return f.extend(b,{action:"wolfnet_get_listings"})}(),beforeSend:function(){a.addClass("wolfnet_refreshing").trigger("wolfnet.updating")}}).done(function(b){k.call(a,
b)}).fail(function(){a.removeClass("wolfnet_refreshing")}).always(function(){})})},next:function(){return this.each(function(){var a=f(this),b=a.data("wolfnetToolbar.state").page+1;i.page.call(a,b)})},prev:function(){return this.each(function(){var a=f(this),b=a.data("wolfnetToolbar.state").page-1;i.page.call(a,b)})},page:function(a){return this.each(function(){var b=f(this),c=b.data("wolfnetToolbar.options"),e=b.data("wolfnetToolbar.state"),c=Math.ceil(c.maxResults/Number(e.numrows)),d=a;1>d?d=c:
d>c&&(d=1);b.data("wolfnetToolbar.state",f.extend(e,{page:d,startrow:(d-1)*Number(e.numrows)+1}));i.update.call(b)})}};f.fn.wolfnetToolbar=function(a){if(i[a])return i[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return i.init.apply(this,arguments);f.error("Method "+a+" does not exist on jQuery."+pluginName)}})(jQuery);
