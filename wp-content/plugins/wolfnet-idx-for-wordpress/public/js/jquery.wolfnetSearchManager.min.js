"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
"undefined"!=typeof jQuery&&function(c){var j={apiGetSuffix:"-get",apiPostSuffix:"-save",apiDeleteSuffix:"-delete",loaderClass:"wolfnet_loaderImage",refreshedEvent:"wolfnetDataRefreshed",savedEvent:"wolfnetSearchSaved",deletedEvent:"wolfnetSearchDelete",itemIdPrefix:"savedsearch_"},i={init:function(d){return this.each(function(){var b=c(this),a={option:c.extend(j,d),savedSearches:[],loading:false,saving:false,deleting:false};a.saveForm=typeof a.option.saveForm=="jQuery"?a.option.saveForm:c(a.option.saveForm);
b.data("wolfnetSearchManager",a);b.wolfnetSearchManager("_createLoaderImage");b.wolfnetSearchManager("refresh");var f=a.saveForm.find("button:first"),e=a.saveForm.find("input:first"),h=function(){if(e.length!=0){e.trigger("submit");var a=e.val().trim()}else a="";if(typeof WNTWP!="undefined"){c("#min_price").change();var d=WNTWP.returnSearchParams();d.keyid=c("#keyid").val()}else d={};b.wolfnetSearchManager("save",a,d)};f.click(h);e.keypress(function(b){b.keyCode==13&&h()});b.bind(a.option.refreshedEvent,
function(){c(this).wolfnetSearchManager("_buildTable")});b.bind(a.option.savedEvent,function(){if(e.length!=0){e.val("");e.trigger("blur")}c(this).data("wolfnetSearchManager",c.extend(a,{saving:false}))});b.bind(a.option.deletedEvent,function(){b.data("wolfnetSearchManager",c.extend(a,{deleting:false}))})})},refresh:function(){return this.each(function(){c(this).wolfnetSearchManager("_loadData")})},save:function(d,b){if(typeof d!="string"||typeof b!="object"){c.error("To perform save on jQuery.wolfnetSearchManager valid description and criteria arguments must be passed.");
return this}if(d.trim()==""){alert("You must specify a description to save your search.");return this}for(var a in b)b[a]=decodeURIComponent(b[a]);return this.each(function(){var a=c(this),e=a.data("wolfnetSearchManager");e.loading||e.saving||e.deleting?alert("Cannot save, please wait until the data has updated."):c.ajax({url:wolfnet_ajax.ajaxurl,dataType:"json",type:"POST",data:{action:"wolfnet_save_search",post_title:d,custom_fields:b},beforeSend:function(){e.loaderImage.show();a.data("wolfnetSearchManager",
c.extend(e,{saving:true}))},success:function(b){e.savedSearches=b;a.data("wolfnetSearchManager",e);a.trigger(e.option.savedEvent);a.trigger(e.option.refreshedEvent)},complete:function(){e.loaderImage.hide()}})})},"delete":function(d){return this.each(function(){var b=c(this),a=b.data("wolfnetSearchManager");a.loading||a.saving||a.deleting?alert("Cannot delete, please wait until the data has updated."):c.ajax({url:wolfnet_ajax.ajaxurl,dataType:"json",type:"GET",data:{action:"wolfnet_delete_search",
id:d,keyid:c("#keyid").val()},beforeSend:function(){a.loaderImage.show();b.data("wolfnetSearchManager",c.extend(a,{deleting:true}))},success:function(c){a.savedSearches=c;b.data("wolfnetSearchManager",a);b.trigger(a.option.deletedEvent);b.trigger(a.option.refreshedEvent)},complete:function(){a.loaderImage.hide()}})})},_createLoaderImage:function(){return this.each(function(){var d=c(this),b=d.data("wolfnetSearchManager"),a=b.option.loaderClass;b.loaderImage=d.find("div."+a+":first");if(b.loaderImage.length==
0){b.loaderImage=c("<div/>");b.loaderImage.append(c('<img src="'+wolfnet_ajax.loaderimg+'" />'));b.loaderImage.addClass(a);b.loaderImage.hide();b.loaderImage.appendTo(d)}d.data("wolfnetSearchManager",b)})},_loadData:function(){return this.each(function(){var d=c(this),b=d.data("wolfnetSearchManager");c.ajax({url:wolfnet_ajax.ajaxurl,data:{action:"wolfnet_saved_searches",keyid:c("#keyid").val()},dataType:"json",type:"GET",beforeSend:function(){b.loaderImage.show();d.data("wolfnetSearchManager",c.extend(b,
{loading:true}))},success:function(a){b.savedSearches=a;d.data("wolfnetSearchManager",b);d.trigger(b.option.refreshedEvent)},complete:function(){d.data("wolfnetSearchManager",c.extend(b,{loading:false}));b.loaderImage.hide()}})})},_buildTable:function(){return this.each(function(){var d=c(this),b=d.data("wolfnetSearchManager"),a=b.savedSearches,f,e,h=d.find("tbody:first");h.children().remove();for(var g in a){var i="post.php?action=edit&post="+a[g].ID;f=c("<tr/>");f.attr("id",b.option.itemIdPrefix+
a[g].ID);f.addClass("savedsearch");f.appendTo(h);g%2==0&&f.addClass("alternate");e=c("<td/>");e.html(a[g].post_title+' (<a href="'+i+'">View Criteria</a>)');e.appendTo(f);e=c("<td/>");e.html(a[g].post_date);e.appendTo(f);e=c("<td/>");e.appendTo(f);f=c("<button/>");f.addClass("button-secondary");f.attr("wnt:search",a[g].ID);f.html("Delete");f.appendTo(e);f.click(function(){d.wolfnetSearchManager("delete",c(this).attr("wnt:search"))})}})}};c.fn.wolfnetSearchManager=function(d){if(i[d])return i[d].apply(this,
Array.prototype.slice.call(arguments,1));if(typeof d==="object"||!d)return i.init.apply(this,arguments);c.error("Method "+d+" does not exist on jQuery.wolfnetSearchManager")}}(jQuery);
