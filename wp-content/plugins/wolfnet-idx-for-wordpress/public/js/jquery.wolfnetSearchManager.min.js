"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),"undefined"!=typeof jQuery&&!function(a){var b="wolfnetSearchManager",c={apiGetSuffix:"-get",apiPostSuffix:"-save",apiDeleteSuffix:"-delete",loaderClass:"wolfnet_loaderImage",refreshedEvent:"wolfnetDataRefreshed",savedEvent:"wolfnetSearchSaved",deletedEvent:"wolfnetSearchDelete",itemIdPrefix:"savedsearch_",baseUrl:"",ajaxUrl:"",ajaxAction:"wolfnet_search_manager_ajax"},d={init:function(e){return this.each(function(){d.interceptAjax(e.baseUrl,e.ajaxUrl,e.ajaxAction);var f=a(this),g={option:a.extend(c,e),savedSearches:[],loading:!1,saving:!1,deleting:!1};"jQuery"==typeof g.option.saveForm?g.saveForm=g.option.saveForm:g.saveForm=a(g.option.saveForm),f.data(b,g),f[b]("_createLoaderImage"),f[b]("refresh");var h=g.saveForm.find("button:first"),i=g.saveForm.find("input:first"),j=function(){if(0!=i.length){i.trigger("submit");var c=i.val().trim()}else var c="";if("undefined"!=typeof WNTWP){a("#min_price").change();var d=WNTWP.returnSearchParams();d.keyid=a("#keyid").val()}else var d={};f[b]("save",c,d)};h.click(j),i.keypress(function(a){13==a.keyCode&&j()}),f.bind(g.option.refreshedEvent,function(){a(this)[b]("_buildTable")}),f.bind(g.option.savedEvent,function(){0!=i.length&&(i.val(""),i.trigger("blur")),a(this).data(b,a.extend(g,{saving:!1}))}),f.bind(g.option.deletedEvent,function(){f.data(b,a.extend(g,{deleting:!1}))})})},interceptAjax:function(b,c,d){a.ajaxSetup({beforeSend:function(a,e){if(e.url.indexOf(b)!=-1||e.url.indexOf("gateway.cfm")!=-1&&e.url.indexOf("isURLSearchBuilder")!=-1&&window.location.href.indexOf("https:")!=-1){var f=e.url.split("?"),g=f[0],h="wnt__url="+g+"&wnt__method="+e.type;e.hasOwnProperty("dataType")&&(h+="&wnt__datatype="+e.dataType),/^(http|\/\/)/.test(g)&&(f.length>1&&(h+="&wnt__params="+encodeURIComponent(f[1])),e.url=c+"?action="+d+"&"+h)}}})},refresh:function(){return this.each(function(){var c=a(this);c[b]("_loadData")})},save:function(c,d){if("string"!=typeof c||"object"!=typeof d)return a.error("To perform save on jQuery."+b+" valid description and criteria arguments must be passed."),this;if(""==c.trim())return alert("You must specify a description to save your search."),this;for(var e in d)d[e]=decodeURIComponent(d[e]);return this.each(function(){var e=a(this),f=e.data(b);return f.loading||f.saving||f.deleting?void alert("Cannot save, please wait until the data has updated."):void a.ajax({url:wolfnet_ajax.ajaxurl,dataType:"json",type:"POST",data:{action:"wolfnet_save_search",post_title:c,custom_fields:d},beforeSend:function(){f.loaderImage.show(),e.data(b,a.extend(f,{saving:!0}))},success:function(a){f.savedSearches=a,e.data(b,f),e.trigger(f.option.savedEvent),e.trigger(f.option.refreshedEvent)},complete:function(){f.loaderImage.hide()}})})},"delete":function(c){return this.each(function(){var d=a(this),e=d.data(b);return e.loading||e.saving||e.deleting?void alert("Cannot delete, please wait until the data has updated."):void a.ajax({url:wolfnet_ajax.ajaxurl,dataType:"json",type:"GET",data:{action:"wolfnet_delete_search",id:c,keyid:a("#keyid").val()},beforeSend:function(){e.loaderImage.show(),d.data(b,a.extend(e,{deleting:!0}))},success:function(a){e.savedSearches=a,d.data(b,e),d.trigger(e.option.deletedEvent),d.trigger(e.option.refreshedEvent)},complete:function(){e.loaderImage.hide()}})})},_createLoaderImage:function(){return this.each(function(){var c=a(this),d=c.data(b),e=d.option.loaderClass;d.loaderImage=c.find("div."+e+":first"),0==d.loaderImage.length&&(d.loaderImage=a("<div/>"),d.loaderImage.append(a('<img src="'+wolfnet_ajax.loaderimg+'" />')),d.loaderImage.addClass(e),d.loaderImage.hide(),d.loaderImage.appendTo(c)),c.data(b,d)})},_loadData:function(){return this.each(function(){var c=a(this),d=c.data(b);a.ajax({url:wolfnet_ajax.ajaxurl,data:{action:"wolfnet_saved_searches",keyid:a("#keyid").val()},dataType:"json",type:"GET",beforeSend:function(){d.loaderImage.show(),c.data(b,a.extend(d,{loading:!0}))},success:function(a){d.savedSearches=a,c.data(b,d),c.trigger(d.option.refreshedEvent)},complete:function(){c.data(b,a.extend(d,{loading:!1})),d.loaderImage.hide()}})})},_buildTable:function(){return this.each(function(){var c,d,e,f,g,h=a(this),i=h.data(b),j=i.savedSearches,k=h.find("tbody:first");k.children().remove();for(var l in j){var m="post.php?action=edit&post="+j[l].ID;c=a("<tr/>"),c.attr("id",i.option.itemIdPrefix+j[l].ID),c.addClass("savedsearch"),c.appendTo(k),l%2==0&&c.addClass("alternate"),d=a("<td/>"),d.html(j[l].post_title+' (<a href="'+m+'">View Criteria</a>)'),d.appendTo(c),e=a("<td/>"),e.html(j[l].post_date),e.appendTo(c),f=a("<td/>"),f.appendTo(c),g=a("<button/>"),g.addClass("button-secondary"),g.attr("wnt:search",j[l].ID),g.html("Delete"),g.appendTo(f),g.click(function(){h[b]("delete",a(this).attr("wnt:search"))})}})}};a.fn[b]=function(c){return d[c]?d[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery."+b):d.init.apply(this,arguments)}}(jQuery);
//# sourceMappingURL=jquery.wolfnetSearchManager.min.js.map